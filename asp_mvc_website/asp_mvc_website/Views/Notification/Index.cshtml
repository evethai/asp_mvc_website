@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@model IEnumerable<GetUsetNotification>
<style>
	body {
		font-family: "Roboto", sans-serif;
		min-height: 100vh;
		position: relative;
	}

	.section-50 {
		padding: 50px 0;
	}

	.m-b-50 {
		margin-bottom: 50px;
	}

	.dark-link {
		color: #333;
	}

	.heading-line {
		position: relative;
		padding-bottom: 5px;
	}

		.heading-line:after {
			content: "";
			height: 4px;
			width: 200px;
			background-color: red;
			position: absolute;
			bottom: 0;
			left: 0;
		}

	.notification-ui_dd-content {
		margin-bottom: 30px;
	}

	.notification-list {
		display: -webkit-box;
		display: -ms-flexbox;
		display: flex;
		-webkit-box-pack: justify;
		-ms-flex-pack: justify;
		justify-content: space-between;
		padding: 20px;
		margin-bottom: 7px;
		background: #fff;
		-webkit-box-shadow: 0 3px 10px rgba(0, 0, 0, 0.06);
		box-shadow: 0 3px 10px rgba(0, 0, 0, 0.06);
	}

	.notification-list--unread {
		border-left: 5px solid red;
	}

	.notification-list .notification-list_content {
		display: -webkit-box;
		display: -ms-flexbox;
		display: flex;
	}

		.notification-list .notification-list_content .notification-list_img img {
			width: 110px;
			margin-right: 20px;
		}

		.notification-list .notification-list_content .notification-list_detail p {
			margin-bottom: 5px;
			line-height: 1.2;
		}

	.notification-list .notification-list_feature-img {
		display: flex;
		flex-direction: column;
		justify-content: space-between;
		align-items: flex-end;
	}

	.abutton {
		background-color: cyan;
		padding: 5px;
		margin: 0 0 4px 0px;
		width: 100px;
		text-align: center;
		border-radius: 5px
	}

	.dbutton {
		background-color: red;
		padding: 5px;
		width: 100px;
		text-align: center;
		border-radius: 5px
	}

</style>
<section class="section-50">
	<div class="container">
		<h3 class="m-b-50 heading-line">Notifications <i class="fa fa-bell text-muted"></i></h3>
		<div class="notification-ui_dd-content">

			@foreach (var item in Model)
			{
				if (item.notiStatus == asp_mvc_website.Enums.NotiStatus.Order && item.isRead == false)
				{
					<div class="notification-list notification-list--unread">
						<div class="notification-list_content">
							<div class="notification-list_img">
								<img src="@item.artwordUrl" alt="user">
							</div>
							<div class="notification-list_detail">
								<p style="color:black"><b>@item.nameUser</b> @item.notificationTitle</p>
								<p class="text-muted">@item.notificationDescription</p>
								<p class="text-muted"><small>@item.dateTime</small></p>
							</div>
						</div>
						<div class="notification-list_feature-img">
							<a class="abutton" id="accept">Accept</a>
							<a class="dbutton" id="deny">Deny</a>
						</div>
					</div>


				}
			}



			@foreach (var item in Model)
			{
				if (!item.isRead && !(item.notiStatus == asp_mvc_website.Enums.NotiStatus.Order))
				{
					<div class="notification-list notification-list--unread">
						<div class="notification-list_content">
							<div class="notification-list_img">
								<img src="@item.artwordUrl" alt="user">
							</div>
							<div class="notification-list_detail">
								<p style="color:black"><b>@item.nameUser</b> @item.notificationTitle</p>
								<p class="text-muted">@item.notificationDescription</p>
								<p class="text-muted"><small>@item.dateTime</small></p>
							</div>
						</div>
						<button action="/Notifi" class="btn btn-primary markRead" data-id="@item.id" data-bs-toggle="modal" data-bs-target="#exampleModal-@item.id">MarkRead</button>
					</div>

					@* ===============modal===================== *@

					<!-- Button trigger modal -->
					<!-- Modal -->
					<div class="modal fade" id="exampleModal-@item.id" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
									<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
								</div>
								<div class="modal-body">
									<h1>@item.notificationDescription</h1>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
									<button type="button" class="btn btn-primary">Save changes</button>
								</div>
							</div>
						</div>
					</div>
				}
			}
			@foreach (var item in Model)
			{
				if (item.isRead)
				{
					<div class="notification-list">
						<div class="notification-list_content">
							<div class="notification-list_img">
								<img src="@item.artwordUrl" alt="user">
							</div>
							<div class="notification-list_detail">
								<p style="color:black"><b>@item.nameUser</b> @item.notificationTitle</p>
								<p class="text-muted">@item.notificationDescription</p>
								<p class="text-muted"><small>@item.dateTime</small></p>
							</div>
						</div>
						@if (item.notiStatus == asp_mvc_website.Enums.NotiStatus.Accept)
						{
							<div class="notification-list_feature-img">
								<div class="abutton" style="color:black">has been approved</div>
							</div>
						}
						@if (item.notiStatus == asp_mvc_website.Enums.NotiStatus.Deny)
						{
							<div class="notification-list_feature-img">
								<div class="dbutton" style="color:black">has been denied</div>
							</div>
						}
					</div>
				}
			}
		</div>

		<div class="text-center">
			<a href="#!" class="dark-link">Load more activity</a>
		</div>
	</div>
</section>

<script>
	$(document).ready(function () {
		$(".markRead").click(function (e) {
			var notifyId = $(this).data("id");
			$.ajax({
				type: "PUT",
				url: "/Notification/MarkReadNoti",
				data: { notificationId: notifyId },
				success: function (data) {
					clickedButton.closest('.notification-list').replaceWith(data);
				},
			});
		});
	});
</script>